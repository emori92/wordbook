{% extends 'base.html' %}

{% load static %}

{% block title %}dashboard{% endblock title %}

{% block dashboard_active %}active{% endblock dashboard_active %}

{% block content %}
  <div class="container">
    <div class="row my-5">
      <div class="col-lg-3 col-md-5 my-5 pt-5 bg-light">

        <!-- profile -->
        <div class="profile">

          <!-- image -->
          {% if account.image %}
            <img src="{{ account.image.url }}" alt="user-image" class="w-100 image-thumbnail rounded-circle">
          {% else %}
            <img src="/media/user/user_default.jpg" alt="user-image" class="w-100 image-thumbnail rounded-circle">
          {% endif %}
  
          <!-- user info-->
          <h1 class="text-center mt-2">{{ account.username }}</h1>
          {% if account.describe %}
            <p>{{ account.describe|linebreaksbr }}</p>
          {% endif %}
          <p class="text-secondary py-3">{{ account.created_at }}</p>

          <!-- user only -->
          {% if user.is_authenticated %}

            {% if user.pk == account.pk %}
              <div class="mx-auto w-50">
                <a href="{% url 'accounts:profile' pk=account.pk %}" class="btn btn-secondary">編集する</a>
              </div>
              <div class="create w-50 mx-auto my-5">
                <a href="{% url 'notepad:note_new' %}" class="display-1 text-white bg-warning rounded-circle d-block text-center"><i class="fas fa-plus"></i></a>
              </div>
            {% else %}
              <!-- follow btn -->
              <div class="mx-auto w-50">
                {% if follow_state == True %}
                  <a href="{% url 'notepad:follow' following=user.pk followed=account.pk %}" class="btn btn-outline-danger mb-3">フォロー解除</a>
                {% else %}
                  <a href="{% url 'notepad:follow' following=user.pk followed=account.pk %}" class="btn btn-primary mb-3">フォロー</a>
                {% endif %}
              </div>
            {% endif %}
            
          {% endif %}
        </div>
      </div>

      <!-- wordbook -->
      <div class="col-lg-9 my-5">
        <!-- ユーザーの場合 非公開といいねした投稿を表示 -->
        {% if user.id == account.id %}
          <!-- 表示切り替え -->
          <div class="mx-auto mb-4 w-50 d-flex">
            <button id="wordbook-btn" class="btn btn-dark mr-3">自分のノート</button>
            <button id="liked-btn" class="btn btn-dark">いいね</button>
          </div>
          <!-- 非公開 -->
          {% include 'components/wordbook.html' with object_list=object_list %}
          <!-- いいね -->
          {% include 'components/wordbook.html' with object_list=liked_note id='liked' display='d-none' name='いいね' %}
        {% else %}
          <!-- ユーザー以外は公開のみ表示 -->
          {% include 'components/wordbook.html' with object_list=public_list %}
        {% endif %}
      </div>
    </div>
  </div>
{% endblock content %}

{% block js %}
  <script src="{% static 'js/notepad/dashboard.js' %}"></script>
{% endblock js %}
